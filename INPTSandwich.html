<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <title>INPT Snack Maker - Official Game</title>
    <style>
      /* --- CSS : Design INPT --- */
      body {
        margin: 0;
        background-color: #f0f4f8;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        color: #333;
      }

      #game-wrapper {
        width: 950px;
        height: 700px;
        background: white;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        border: 3px solid #0056b3; /* Bleu INPT */
      }

      /* En-t√™te avec Logo */
      header {
        background: linear-gradient(90deg, #0056b3, #003d80);
        color: white;
        padding: 10px 30px;
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 70px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
      }

      .logo-area {
        display: flex;
        align-items: center;
        gap: 15px;
        font-size: 24px;
        font-weight: bold;
      }

      /* Si tu as le vrai logo, remplace le src */
      #inpt-logo {
        height: 50px;
        width: 50px;
        background: white;
        border-radius: 50%;
        padding: 2px;
        object-fit: contain;
      }

      .stats-area {
        font-size: 20px;
        font-weight: bold;
        display: flex;
        gap: 20px;
      }

      /* Zone Principale */
      #main-area {
        flex: 1;
        display: flex;
        position: relative;
      }

      /* Colonne Gauche : Le Client (INPTiste) */
      #customer-panel {
        width: 35%;
        background: #eef6fc;
        padding: 20px;
        border-right: 2px solid #ddd;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-start;
      }

      /* Bulle de commande visuelle */
      .bubble {
        background: white;
        border: 2px solid #333;
        border-radius: 20px;
        padding: 15px;
        margin-top: 10px;
        width: 90%;
        min-height: 120px;
        position: relative;
        box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        align-items: center;
      }
      .bubble::after {
        content: "";
        position: absolute;
        bottom: -12px;
        left: 50%;
        border-width: 12px 12px 0;
        border-style: solid;
        border-color: #333 transparent;
        transform: translateX(-50%);
      }

      .bubble h4 {
        margin: 0 0 10px 0;
        color: #555;
        font-size: 14px;
        text-transform: uppercase;
      }

      /* Conteneur des images de commande */
      #order-visuals {
        display: flex;
        flex-direction: column-reverse; /* Important : pour afficher l'ordre de bas en haut comme le sandwich */
        gap: 5px;
        width: 100%;
        align-items: center;
        max-height: 250px;
        overflow-y: auto;
      }

      .order-icon {
        width: 180px;
        height: 25px;
        border-radius: 5px;
        display: flex;
        justify-content: center;
        align-items: center;
        font-size: 14px;
        color: white;
        text-shadow: 1px 1px 0 rgba(0, 0, 0, 0.5);
        box-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
        font-weight: bold;
      }

      /* Infos Client */
      #customer-info {
        margin-top: 30px;
        text-align: center;
      }
      #customer-avatar {
        font-size: 90px;
      }
      #customer-filiere {
        font-weight: 900;
        font-size: 22px;
        color: #0056b3;
        margin: 5px 0;
      }
      #customer-year {
        font-weight: bold;
        color: #666;
        background: #ddd;
        padding: 2px 10px;
        border-radius: 10px;
        font-size: 14px;
      }

      /* Colonne Droite : Pr√©paration */
      #prep-area {
        width: 65%;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: flex-end;
        padding-bottom: 20px;
        background-image: radial-gradient(#ccc 10%, transparent 10%);
        background-size: 20px 20px;
      }

      #plate {
        width: 300px;
        height: 380px;
        display: flex;
        flex-direction: column-reverse;
        align-items: center;
        justify-content: flex-start;
        margin-bottom: 10px;
        position: relative;
      }

      #plate::before {
        content: "";
        position: absolute;
        bottom: -15px;
        width: 260px;
        height: 15px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 50%;
      }

      /* Styles des ingr√©dients (Partag√©s entre bouton, commande et plateau) */
      .ing-style {
        display: flex;
        align-items: center;
        justify-content: center;
      }
      .pain {
        background: #d4a373;
        border: 1px solid #b08d55;
      }
      .viande {
        background: #8b4513;
      }
      .frites {
        background: #f1c40f;
        color: black !important;
        text-shadow: none !important;
        border: 1px solid #d4ac0d;
      }
      .salade {
        background: #2ecc71;
      }
      .fromage {
        background: #f39c12;
      }
      .tomate {
        background: #e74c3c;
      }
      .sauce {
        background: #c0392b;
      }

      /* Couches sur le plateau */
      .layer {
        width: 200px;
        height: 32px;
        border-radius: 8px;
        margin-bottom: -8px;
        z-index: 10;
        color: white;
        font-weight: bold;
        text-shadow: 1px 1px 2px black;
        animation: dropIn 0.2s cubic-bezier(0.5, 0, 0.5, 1.5);
        border: 2px solid rgba(0, 0, 0, 0.1);
      }
      .layer.pain {
        width: 220px;
        height: 40px;
        border-radius: 15px;
      }
      .layer.sauce {
        width: 180px;
        height: 15px;
        border-radius: 50px;
      }
      .layer.frites {
        width: 190px;
        border-style: dashed;
      }

      @keyframes dropIn {
        from {
          transform: translateY(-100px);
          opacity: 0;
        }
        to {
          transform: translateY(0);
          opacity: 1;
        }
      }

      /* Contr√¥les */
      #controls {
        background: #fff;
        padding: 15px;
        width: 100%;
        display: flex;
        justify-content: center;
        gap: 8px;
        border-top: 2px solid #ddd;
      }

      .btn-ing {
        padding: 8px 12px;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        font-size: 13px;
        transition: transform 0.1s;
        display: flex;
        flex-direction: column;
        align-items: center;
        color: white;
        box-shadow: 0 4px 0 rgba(0, 0, 0, 0.2);
        width: 70px;
      }
      .btn-ing:active {
        transform: translateY(4px);
        box-shadow: none;
      }
      .btn-ing span {
        font-size: 22px;
        margin-bottom: 2px;
      }

      .btn-action {
        padding: 0 20px;
        font-size: 16px;
        border-radius: 8px;
        border: none;
        cursor: pointer;
        font-weight: bold;
        color: white;
      }
      #btn-trash {
        background: #7f8c8d;
      }
      #btn-serve {
        background: #27ae60;
        font-size: 18px;
        box-shadow: 0 4px 0 #1e8449;
        width: 120px;
      }
      #btn-serve:active {
        transform: translateY(4px);
        box-shadow: none;
      }

      /* √âcrans */
      #overlay {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.92);
        color: white;
        display: none;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 100;
      }
      #restart-btn {
        padding: 15px 40px;
        font-size: 22px;
        background: #f1c40f;
        color: #333;
        font-weight: bold;
        border: none;
        border-radius: 50px;
        cursor: pointer;
        margin-top: 20px;
      }

      .feedback {
        position: absolute;
        font-size: 50px;
        font-weight: 900;
        top: 40%;
        left: 60%;
        transform: translate(-50%, -50%);
        animation: popUp 0.8s forwards;
        z-index: 50;
        text-shadow: 3px 3px 0 white;
        pointer-events: none;
      }
      .back-to-menu {
        position: fixed;
        top: 90px; /* Juste en dessous du Header */
        left: 1150px;
        background-color: #ffcc00; /* Jaune sandwich */
        color: #000;
        border: none;
        padding: 10px 20px;
        font-size: 1rem;
        font-weight: bold;
        border-radius: 50px;
        cursor: pointer;
        box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        z-index: 1001; /* Pour √™tre au-dessus du reste */
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .back-to-menu:hover {
        background-color: #e6b800;
        transform: translateX(
          -5px
        ); /* Petit effet de mouvement vers la gauche */
      }

      .back-to-menu .arrow {
        font-size: 1.2rem;
      }

      /* Version mobile : on r√©duit un peu la taille */
      @media (max-width: 600px) {
        .back-to-menu {
          padding: 8px 15px;
          font-size: 0.8rem;
          top: 80px;
        }
      }
      @keyframes popUp {
        0% {
          opacity: 0;
          transform: scale(0);
        }
        50% {
          opacity: 1;
          transform: scale(1.2);
        }
        100% {
          opacity: 0;
          transform: translateY(-100px);
        }
      }
    </style>
  </head>
  <body>
    <div id="game-wrapper">
      <header>
        <div class="logo-area">
          <img id="inpt-logo" src="inpt.png" alt="Logo INPT" />
          <span>INPT SNACK</span>
        </div>
        <div class="stats-area">
          <span>‚è≥ <span id="timer">60</span>s</span>
          <span>üí∞ <span id="score">0</span> DH</span>
        </div>
      </header>

      <div id="main-area">
        <div id="customer-panel">
          <div class="bubble">
            <h4>Commande :</h4>
            <div id="order-visuals"></div>
          </div>

          <div id="customer-info">
            <div id="customer-avatar">üòé</div>
            <div id="customer-filiere">ASEDS</div>
            <span id="customer-year">2√®me Ann√©e</span>
          </div>
        </div>

        <div id="prep-area">
          <div id="plate"></div>
        </div>
      </div>

      <div id="controls">
        <button class="btn-ing pain" onclick="addIng('pain')">
          <span>ü•ñ</span>Pain
        </button>
        <button class="btn-ing sauce" onclick="addIng('sauce')">
          <span>üå∂Ô∏è</span>Harissa
        </button>
        <button class="btn-ing viande" onclick="addIng('viande')">
          <span>ü•©</span>Kafta
        </button>
        <button class="btn-ing frites" onclick="addIng('frites')">
          <span>üçü</span>Frites
        </button>
        <button class="btn-ing fromage" onclick="addIng('fromage')">
          <span>üßÄ</span>Fromage
        </button>
        <button class="btn-ing salade" onclick="addIng('salade')">
          <span>ü•¨</span>Salade
        </button>
        <button class="btn-ing tomate" onclick="addIng('tomate')">
          <span>üçÖ</span>Tomate
        </button>

        <button class="btn-action" id="btn-trash" onclick="trashSandwich()">
          üóëÔ∏è
        </button>
        <button class="btn-action" id="btn-serve" onclick="serveSandwich()">
          SERVIR
        </button>
      </div>

      <div id="overlay">
        <h1 style="color: #f1c40f">FIN DE SERVICE !</h1>
        <p style="font-size: 24px">
          √âtudiants nourris : <span id="final-count">0</span>
        </p>
        <p style="font-size: 30px">
          Chiffre d'affaire : <span id="final-score">0</span> DH
        </p>
        <button id="restart-btn" onclick="startGame()">
          R√©ouvrir le Snack
        </button>
      </div>
    </div>
    <button class="back-to-menu" onclick="window.location.href='s1.html'">
      <span class="arrow">‚Üê</span> Retour au Menu
    </button>

    <script>
      /* --- JAVASCRIPT --- */

      let currentStack = [];
      let currentOrder = [];
      let score = 0;
      let timeLeft = 60;
      let timerInterval;
      let gameActive = false;
      let customersServed = 0;

      // Config Ingr√©dients
      const ingredients = {
        pain: { label: "Pain", class: "pain", icon: "ü•ñ" },
        viande: { label: "Kefta", class: "viande", icon: "ü•©" },
        frites: { label: "Frites", class: "frites", icon: "üçü" },
        salade: { label: "Salade", class: "salade", icon: "ü•¨" },
        fromage: { label: "Fromage", class: "fromage", icon: "üßÄ" },
        tomate: { label: "Tomate", class: "tomate", icon: "üçÖ" },
        sauce: { label: "Harissa", class: "sauce", icon: "üå∂Ô∏è" },
      };

      // --- NOUVEAU : Donn√©es INPT ---
      const filieres = [
        "ASEDS",
        "ICCN",
        "DATA",
        "AMOA",
        "SMART",
        "SESNUM",
        "CLOUD",
      ];
      const annees = ["1√®re Ann√©e", "2√®me Ann√©e", "3√®me Ann√©e"];
      const avatars = ["üë®‚Äçüíª", "üë©‚Äçüíª", "ü§î", "üòé", "ü§Ø", "ü§ì"];

      // Elements
      const plateEl = document.getElementById("plate");
      const orderVisualsEl = document.getElementById("order-visuals");
      const scoreEl = document.getElementById("score");
      const timerEl = document.getElementById("timer");
      const overlayEl = document.getElementById("overlay");
      const avatarEl = document.getElementById("customer-avatar");
      const filiereEl = document.getElementById("customer-filiere");
      const yearEl = document.getElementById("customer-year");

      function startGame() {
        score = 0;
        timeLeft = 90; // Un peu plus de temps
        customersServed = 0;
        gameActive = true;
        overlayEl.style.display = "none";
        updateUI();

        clearInterval(timerInterval);
        timerInterval = setInterval(() => {
          timeLeft--;
          timerEl.innerText = timeLeft;
          if (timeLeft <= 0) endGame();
        }, 1000);

        nextCustomer();
      }

      function endGame() {
        gameActive = false;
        clearInterval(timerInterval);
        document.getElementById("final-score").innerText = score;
        document.getElementById("final-count").innerText = customersServed;
        overlayEl.style.display = "flex";
      }

      function nextCustomer() {
        trashSandwich();

        // --- G√©n√©ration Al√©atoire INPT ---
        const randFiliere =
          filieres[Math.floor(Math.random() * filieres.length)];
        const randAnnee = annees[Math.floor(Math.random() * annees.length)];
        const randAvatar = avatars[Math.floor(Math.random() * avatars.length)];

        filiereEl.innerText = randFiliere;
        yearEl.innerText = randAnnee;
        avatarEl.innerText = randAvatar;

        // Logique de couleur par fili√®re (juste pour le fun)
        if (randFiliere === "DATA") filiereEl.style.color = "#e67e22";
        else if (randFiliere === "ASEDS") filiereEl.style.color = "#2980b9";
        else filiereEl.style.color = "#0056b3";

        // G√©n√©rer Recette
        const keys = Object.keys(ingredients);
        const numIngs = Math.floor(Math.random() * 4) + 3; // 3 √† 6 ingr√©dients

        currentOrder = [];
        currentOrder.push("pain"); // Bas

        for (let i = 0; i < numIngs; i++) {
          const randomKey = keys[Math.floor(Math.random() * keys.length)];
          if (randomKey !== "pain") currentOrder.push(randomKey);
        }

        currentOrder.push("pain"); // Haut

        displayOrderVisuals();
      }

      function displayOrderVisuals() {
        orderVisualsEl.innerHTML = "";

        // Pour l'affichage visuel, on parcourt le tableau.
        // Comme le CSS est en column-reverse, le premier √©l√©ment ajout√© au DOM sera en BAS visuellement.
        // Notre tableau currentOrder est [Bas, Milieu, ..., Haut].
        // Donc on it√®re normalement.

        currentOrder.forEach((ingKey) => {
          const ing = ingredients[ingKey];

          // Cr√©ation de la "Photo" de l'ingr√©dient
          let visualDiv = document.createElement("div");
          visualDiv.className = `order-icon ${ing.class}`;
          visualDiv.innerHTML = `${ing.icon} ${ing.label}`;

          orderVisualsEl.appendChild(visualDiv);
        });
      }

      function addIng(type) {
        if (!gameActive) return;

        currentStack.push(type);
        const ing = ingredients[type];

        // Ajouter sur le plateau
        const div = document.createElement("div");
        div.className = `layer ing-style ${ing.class}`;
        div.innerText = ing.icon; // Juste l'ic√¥ne sur le sandwich
        plateEl.appendChild(div);
      }

      function trashSandwich() {
        currentStack = [];
        plateEl.innerHTML = "";
      }

      function serveSandwich() {
        if (!gameActive) return;

        if (checkOrder()) {
          score += 15; // Prix du sandwich
          customersServed++;
          showFeedback("MCI ! üëç", "#27ae60");
          document.getElementById("game-wrapper").style.borderColor = "#2ecc71";
          setTimeout(
            () =>
              (document.getElementById("game-wrapper").style.borderColor =
                "#0056b3"),
            300
          );
          setTimeout(nextCustomer, 800);
        } else {
          score -= 5;
          showFeedback("C'EST FAUX ! üò°", "#c0392b");
          const wrapper = document.getElementById("game-wrapper");
          wrapper.animate(
            [
              { transform: "translateX(0)" },
              { transform: "translateX(-10px)" },
              { transform: "translateX(10px)" },
              { transform: "translateX(0)" },
            ],
            { duration: 300 }
          );
        }
        updateUI();
      }

      function checkOrder() {
        if (currentStack.length !== currentOrder.length) return false;
        for (let i = 0; i < currentStack.length; i++) {
          if (currentStack[i] !== currentOrder[i]) return false;
        }
        return true;
      }

      function updateUI() {
        scoreEl.innerText = score;
      }

      function showFeedback(text, color) {
        const el = document.createElement("div");
        el.className = "feedback";
        el.innerText = text;
        el.style.color = color;
        document.body.appendChild(el);
        setTimeout(() => el.remove(), 1000);
      }

      // Init
      startGame();
    </script>
  </body>
</html>
